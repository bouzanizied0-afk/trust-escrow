<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>QUP Command Center - Pure Template</title>
    <style>
        body {
            margin: 0; background-color: #050505; color: #2ecc71;
            font-family: 'Courier New', monospace;
            display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden;
        }
        .status-bar {
            width: 100%; padding: 10px; background: #111;
            display: flex; justify-content: center; align-items: center; gap: 30px;
            border-bottom: 2px solid #222; font-size: 0.8rem;
        }
        .status-item { display: flex; align-items: center; gap: 8px; }
        .led { width: 12px; height: 12px; border-radius: 50%; background: #330000; transition: 0.5s; border: 1px solid #000; }
        
        #main-counter {
            font-size: 5rem; font-weight: bold; margin: 10px 0;
            text-shadow: 0 0 20px #2ecc71; color: #39ff14;
        }
        .container {
            display: grid; grid-template-columns: 1fr 380px;
            gap: 15px; width: 98%; height: 70vh;
        }
        .display-unit {
            background: #000; border: 2px solid #2ecc71; position: relative;
            display: flex; align-items: center; justify-content: center; overflow: hidden;
        }
        #radar-canvas { position: absolute; width: 100%; height: 100%; opacity: 0.3; z-index: 1; }
        #tv-image, #tv-video { max-width: 95%; max-height: 95%; display: none; z-index: 5; border: 1px solid #2ecc71; }

        .panel { display: flex; flex-direction: column; gap: 10px; height: 100%; }
        #chat-box {
            flex-grow: 1; background: rgba(0,15,0,0.9); border: 1px solid #2ecc71;
            padding: 10px; font-size: 0.85rem; overflow-y: auto; color: #39ff14;
        }
        .chat-input-area { display: flex; gap: 5px; }
        #chatInput { 
            flex-grow: 1; background: #000; border: 1px solid #2ecc71; color: #39ff14; padding: 8px; outline: none;
        }
        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        button {
            padding: 12px; cursor: pointer; border: none; font-weight: bold;
            background: #2ecc71; color: #000;
        }
        .btn-danger { background: #e74c3c; color: white; margin-top: auto; }
    </style>
</head>
<body>

    <div class="status-bar">
        <div class="status-item">
            <div id="led-fb" class="led"></div> <span>FIREBASE</span>
        </div>
        <div class="status-item">
            <div id="led-core" class="led"></div> <span>qup_core.js</span>
        </div>
        <div class="status-item">
            <div id="led-rcv" class="led"></div> <span>qup_receiver.js</span>
        </div>
    </div>

    <div id="main-counter">0%</div>

    <div class="container">
        <div class="display-unit">
            <canvas id="radar-canvas"></canvas>
            <img id="tv-image">
            <video id="tv-video" controls autoplay loop></video>
        </div>

        <div class="panel">
            <div id="chat-box">>> ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø±Ø¨Ø· Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©...</div>
            <div class="chat-input-area">
                <input type="text" id="chatInput" placeholder="Ø§Ù„Ù†Ø¸Ø§Ù… ØµØ§Ù…Øª...">
                <button id="sendMsgBtn">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
            
            <input type="file" id="fileInput" style="display: none;" accept="image/*,video/*">
            <div class="btn-group">
                <button id="uploadBtn" onclick="document.getElementById('fileInput').click()">ğŸ“‚ Ø±ÙØ¹ Ù…Ù„Ù</button>
                <button id="sendBtn" style="background: #39ff14;">ğŸš€ Ø¨Ø« Ø§Ù„Ù†Ø¨Ø¶Ø©</button>
            </div>
            <button class="btn-danger" id="clearBtn">ğŸ’€ Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAZs0bb_t-bzMtaJqy_W_QDBSdQKHLEiD4",
            authDomain: "ziedzizou-7b74d.firebaseapp.com",
            databaseURL: "https://ziedzizou-7b74d-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "ziedzizou-7b74d"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù„Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ ÙÙ‚Ø·
        window.db = db;
        window.mainCounter = document.getElementById('main-counter');
        window.chatBox = document.getElementById('chat-box');

        const ledFb = document.getElementById('led-fb');
        const ledCore = document.getElementById('led-core');
        const ledRcv = document.getElementById('led-rcv');

        // ÙØ­Øµ Ø§ØªØµØ§Ù„ Firebase Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
        onValue(ref(db, ".info/connected"), (snap) => {
            ledFb.style.background = snap.val() === true ? "#2ecc71" : "red";
            if(snap.val()) ledFb.style.boxShadow = "0 0 10px #2ecc71";
        });

        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø±Ø¨Ø· Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© (Ø£Ø­Ø±Ù ØµØºÙŠØ±Ø©)
        // Ø§Ù„Ù€ Index Ù‡Ù†Ø§ Ù„Ø§ ÙŠÙ…Ù„Ùƒ Ø£ÙŠ Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ØŒ Ù‡Ùˆ ÙÙ‚Ø· ÙŠØ­Ø§ÙˆÙ„ Ø§Ø³ØªÙŠØ±Ø§Ø¯Ù‡Ø§
        try {
            import('./qup_core.js').then(m => {
                ledCore.style.background = "#2ecc71";
                ledCore.style.boxShadow = "0 0 10px #2ecc71";
                // Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø²Ø± Ø§Ù„Ø¨Ø« ÙŠØªÙ… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ Ø£Ùˆ Ø¹Ø¨Ø± window
                window.QUP_Core = m.QUP_Core;
            }).catch(() => ledCore.style.background = "red");

            import('./qup_receiver_ultimate.js').then(() => {
                ledRcv.style.background = "#2ecc71";
                ledRcv.style.boxShadow = "0 0 10px #2ecc71";
            }).catch(() => ledRcv.style.background = "red");
        } catch(e) {}

        // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙˆØ³Ø§Ø¦Ø· (ÙÙŠØ¯ÙŠÙˆ/ØµÙˆØ±) Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·
        document.getElementById('fileInput').onchange = (e) => {
            const file = e.target.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                const img = document.getElementById('tv-image');
                const video = document.getElementById('tv-video');
                if (file.type.startsWith('video/')) {
                    img.style.display="none"; video.style.display="block"; video.src=url;
                } else {
                    video.style.display="none"; img.style.display="block"; img.src=url;
                }
            }
        };

        // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø£Ø²Ø±Ø§Ø± "Ø¥Ø±Ø³Ø§Ù„" Ùˆ "Ø¨Ø«" Ùˆ "Ø­Ø°Ù" Ù„ÙŠØ³ Ù„Ù‡Ø§ ÙˆØ¸Ø§Ø¦Ù Ù‡Ù†Ø§ (Ù‚Ø§Ù„Ø¨ Ù…ÙŠØª)
        // ÙŠØ¬Ø¨ Ø¨Ø±Ù…Ø¬ØªÙ‡Ø§ Ø¯Ø§Ø®Ù„ qup_core.js Ø£Ùˆ qup_receiver_ultimate.js
    </script>
</body>
</html>
